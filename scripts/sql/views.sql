-- Active: 1721493258336@@127.0.0.1@3306 

-- Vis√£o Geral 
SELECT * FROM dva;

SELECT * FROM dva_wide;

SELECT * FROM igp_di;

SELECT * FROM pib_bcb;

-- Glimpse
PRAGMA table_info(pip_bcb);

-- Por Setor de Atividade
SELECT SETOR_ATIV, DS_CONTA, SUM(VL_CONTA)
FROM dva
WHERE SETOR_ATIV IS NOT NULL
GROUP BY SETOR_ATIV, DS_CONTA
ORDER BY SETOR_ATIV, CD_CONTA ASC;


-- DVA WIDE

SELECT SETOR_ATIV, DS_CONTA, *
FROM dva_wide
WHERE "2009" IS NOT NULL
AND "2010" IS NOT NULL
AND "2011" IS NOT NULL
AND "2012" IS NOT NULL
AND "2013" IS NOT NULL
AND "2014" IS NOT NULL
AND "2015" IS NOT NULL
AND "2016" IS NOT NULL
AND "2017" IS NOT NULL
AND "2018" IS NOT NULL
AND "2019" IS NOT NULL
AND "2020" IS NOT NULL
AND "2021" IS NOT NULL
AND "2022" IS NOT NULL
AND "2023" IS NOT NULL
ORDER BY SETOR_ATIV, CD_CONTA;

-- PAINEL BALANCEADO

SELECT COUNT(DISTINCT CD_CVM) AS numero_empresas
FROM dva_wide
WHERE "2009" IS NOT NULL
AND "2010" IS NOT NULL
AND "2011" IS NOT NULL
AND "2012" IS NOT NULL
AND "2013" IS NOT NULL
AND "2014" IS NOT NULL
AND "2015" IS NOT NULL
AND "2016" IS NOT NULL
AND "2017" IS NOT NULL
AND "2018" IS NOT NULL
AND "2019" IS NOT NULL
AND "2020" IS NOT NULL
AND "2021" IS NOT NULL
AND "2022" IS NOT NULL
AND "2023" IS NOT NULL;


SELECT SETOR_ATIV, CD_CVM, CD_CONTA, DS_CONTA,
    "2009","2010","2011","2012","2013","2014",
    "2015","2016","2017","2018","2019","2020",
    "2021","2022","2023"
FROM dva_wide
WHERE 
        "2009" IS NOT NULL
    AND "2010" IS NOT NULL
    AND "2011" IS NOT NULL
    AND "2012" IS NOT NULL
    AND "2013" IS NOT NULL
    AND "2014" IS NOT NULL
    AND "2015" IS NOT NULL
    AND "2016" IS NOT NULL
    AND "2017" IS NOT NULL
    AND "2018" IS NOT NULL
    AND "2019" IS NOT NULL
    AND "2020" IS NOT NULL
    AND "2021" IS NOT NULL
    AND "2022" IS NOT NULL
    AND "2023" IS NOT NULL
GROUP BY CD_CVM, DS_CONTA;

-- PIVOT
SELECT ANO, SETOR_ATIV,
    SUM(CASE WHEN DS_CONTA = 'Receitas' THEN VL_CONTA ELSE 0 END) AS Receitas,
    SUM(CASE WHEN DS_CONTA = 'VAB' THEN VL_CONTA ELSE 0 END) AS VAB,
    SUM(CASE WHEN DS_CONTA = 'VALP' THEN VL_CONTA ELSE 0 END) AS VALP,
    SUM(CASE WHEN DS_CONTA = 'VATD' THEN VL_CONTA ELSE 0 END) AS VATD,
        SUM(CASE WHEN DS_CONTA = 'Pessoal' THEN VL_CONTA ELSE 0 END) AS Pessoal,
        SUM(CASE WHEN DS_CONTA = 'Governo' THEN VL_CONTA ELSE 0 END) AS Governo,
        SUM(CASE WHEN DS_CONTA = 'RCP' THEN VL_CONTA ELSE 0 END) AS RCP,
        SUM(CASE WHEN DS_CONTA = 'RCT' THEN VL_CONTA ELSE 0 END) AS RCT

FROM dva
WHERE SETOR_ATIV IS NOT NULL
GROUP BY ANO, SETOR_ATIV
ORDER BY ANO, SETOR_ATIV;


SELECT SUM(VATD)
FROM dva_igpdi
WHERE ANO = 2009;
